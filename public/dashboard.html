<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>

body{
margin:0;
font-family:Arial;
background:#0b0b12;
color:white;
}

/* SIDE MENU */

.menu{
position:fixed;
left:-260px;
top:0;
width:260px;
height:100%;
background:#141422;
transition:0.3s;
padding-top:20px;
z-index:1000;
}

.menu a{
display:block;
padding:15px;
color:gold;
text-decoration:none;
}

.menu.active{left:0}

/* HEADER */

.header{
background:#141422;
padding:15px;
display:flex;
justify-content:space-between;
align-items:center;
}

.section{
display:none;
padding:15px;
}

.section.active{
display:block;
}

.card{
background:#141422;
padding:15px;
border-radius:10px;
margin-bottom:10px;
}

button{
padding:10px;
background:gold;
border:none;
border-radius:8px;
margin-top:10px;
}

input,select{
width:100%;
padding:10px;
margin-top:8px;
border-radius:8px;
border:none;
}

/* WHEEL */

#wheel{
width:250px;
height:250px;
margin:auto;
border-radius:50%;
background:conic-gradient(
gold 0deg 60deg,
red 60deg 120deg,
blue 120deg 180deg,
green 180deg 240deg,
purple 240deg 300deg,
orange 300deg 360deg
);
transition:transform 5s cubic-bezier(.17,.67,.83,.67);
}

/* NOTIFY */

.notify{
position:fixed;
top:-80px;
left:50%;
transform:translateX(-50%);
padding:12px 25px;
border-radius:10px;
font-weight:bold;
transition:0.4s;
z-index:9999;
}

.notify.show{top:20px}
.notify.success{background:#00c853;color:white}
.notify.error{background:#ff1744;color:white}

</style>

</head>

<body>

<div id="notifyBox" class="notify"></div>

<div class="menu" id="menu">

<a onclick="show('home')">Home</a>
<a onclick="show('deposit')">Deposit</a>
<a onclick="show('withdraw')">Withdraw</a>
<a onclick="show('wins')">Wins</a>
<a onclick="show('contact')">Contact</a>
<a href="/logout">Logout</a>

</div>

<div class="header">
<button onclick="toggle()">â˜°</button>
<div id="balance">Balance:0</div>
</div>

<!-- HOME -->

<div id="home" class="section active">
<div class="card">
<div id="wheel"></div>
<button onclick="spin()">SPIN</button>
</div>
</div>

<!-- DEPOSIT -->

<div id="deposit" class="section">
<div class="card">

<h3>Deposit</h3>

<input id="amount" placeholder="Amount">
<button onclick="submitDeposit()">Submit Deposit</button>

<h4>History</h4>
<div id="depositHistory"></div>

</div>
</div>

<!-- WITHDRAW -->

<div id="withdraw" class="section">
<div class="card">

<h3>Withdraw</h3>

<input id="wAmount" placeholder="Amount">
<button onclick="submitWithdraw()">Submit Withdraw</button>

</div>
</div>

<!-- WINS -->

<div id="wins" class="section">
<div class="card">
<h3>Win History</h3>
<div id="winsList"></div>
</div>
</div>

<!-- CONTACT -->

<div id="contact" class="section">
<div class="card">
Support WhatsApp: 03457526986
</div>
</div>

<script>

function notify(message,type="success"){
let box=document.getElementById("notifyBox");
box.innerText=message;
box.className="notify show "+type;
setTimeout(()=>{box.className="notify"},3000);
}

function toggle(){
document.getElementById("menu").classList.toggle("active");
}

function show(id){
document.querySelectorAll(".section").forEach(s=>s.classList.remove("active"));
document.getElementById(id).classList.add("active");
toggle();
}

/* BALANCE */

function loadBalance(){
fetch("/balance")
.then(r=>r.json())
.then(d=>{
document.getElementById("balance").innerText="Balance:"+d.balance;
});
}

loadBalance();
setInterval(loadBalance,4000);

/* SPIN */

function spin(){

fetch("/spin",{method:"POST"})
.then(r=>r.json())
.then(data=>{

if(data.error){
notify(data.error,"error");
return;
}

let degree=1440+Math.random()*360;

document.getElementById("wheel").style.transform="rotate("+degree+"deg)";

notify("You won "+data.win,"success");

loadBalance();
loadWins();

});

}

/* DEPOSIT */

function submitDeposit(){

fetch("/deposit",{
method:"POST",
headers:{"Content-Type":"application/json"},
body:JSON.stringify({
amount:document.getElementById("amount").value
})
})
.then(r=>r.json())
.then(data=>{
notify(data.message,data.type);
loadDepositHistory();
});

}

function loadDepositHistory(){

fetch("/user-deposits")
.then(r=>r.json())
.then(data=>{

let html="";

data.forEach(d=>{
html+="<div>"+d.amount+" | "+d.status+"</div>";
});

document.getElementById("depositHistory").innerHTML=html;

});

}

loadDepositHistory();

/* WITHDRAW */

function submitWithdraw(){

fetch("/withdraw",{
method:"POST",
headers:{"Content-Type":"application/json"},
body:JSON.stringify({
amount:document.getElementById("wAmount").value
})
})
.then(r=>r.json())
.then(data=>{
notify(data.message,data.type);
});

}

/* WIN HISTORY */

function loadWins(){

fetch("/user-wins")
.then(r=>r.json())
.then(data=>{

let html="";

data.forEach(w=>{
html+="<div>Win:"+w.amount+"</div>";
});

document.getElementById("winsList").innerHTML=html;

});

}

loadWins();

</script>

</body>
</html>
