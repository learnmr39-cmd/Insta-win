<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{margin:0;font-family:Arial;background:#0b0b12;color:white}
.header{background:#141422;padding:15px;display:flex;justify-content:space-between}
.card{background:#141422;padding:15px;margin:15px;border-radius:10px}
button{padding:10px;background:gold;border:none;border-radius:8px;margin-top:10px}
input{width:100%;padding:10px;margin-top:8px;border-radius:8px;border:none}
#wheel{width:200px;height:200px;margin:auto;border-radius:50%;
background:conic-gradient(gold 0 60deg,red 60 120deg,blue 120 180deg,green 180 240deg,purple 240 300deg,orange 300 360deg);
transition:transform 4s ease-out}

/* NOTIFICATION */
.notify{
position:fixed;
top:-80px;
left:50%;
transform:translateX(-50%);
padding:12px 25px;
border-radius:10px;
font-weight:bold;
transition:0.4s;
z-index:9999;
}
.notify.show{top:20px}
.notify.success{background:#00c853;color:white}
.notify.error{background:#ff1744;color:white}
</style>
</head>
<body>

<div id="notifyBox" class="notify"></div>

<div class="header">
<div>Silk Casino</div>
<div id="balance">Balance:0</div>
</div>

<div class="card">
<div id="wheel"></div>
<button onclick="spin()">SPIN</button>
</div>

<div class="card">
<h3>Deposit</h3>
<input id="amount" placeholder="Amount">
<button onclick="submitDeposit()">Submit Deposit</button>
<div id="depositHistory"></div>
</div>

<div class="card">
<h3>Withdraw</h3>
<input id="wAmount" placeholder="Amount">
<button onclick="submitWithdraw()">Submit Withdraw</button>
</div>

<div class="card">
<h3>Win History</h3>
<div id="winsList"></div>
</div>

<script>

function notify(message,type="success"){
let box=document.getElementById("notifyBox");
box.innerText=message;
box.className="notify show "+type;
setTimeout(()=>{box.className="notify"},3000);
}

function loadBalance(){
fetch("/balance").then(r=>r.json()).then(d=>{
document.getElementById("balance").innerText="Balance:"+d.balance;
});
}
loadBalance();

function spin(){
fetch("/spin",{method:"POST"})
.then(r=>r.json())
.then(data=>{
if(data.error){notify(data.error,"error");return;}
document.getElementById("wheel").style.transform="rotate("+(1440+Math.random()*360)+"deg)";
notify("You won "+data.win,"success");
loadBalance();
loadWins();
});
}

function submitDeposit(){
fetch("/deposit",{
method:"POST",
headers:{"Content-Type":"application/json"},
body:JSON.stringify({amount:document.getElementById("amount").value})
})
.then(r=>r.json())
.then(data=>{
notify(data.message,data.type);
loadDepositHistory();
});
}

function submitWithdraw(){
fetch("/withdraw",{
method:"POST",
headers:{"Content-Type":"application/json"},
body:JSON.stringify({amount:document.getElementById("wAmount").value})
})
.then(r=>r.json())
.then(data=>{
notify(data.message,data.type);
});
}

function loadDepositHistory(){
fetch("/user-deposits")
.then(r=>r.json())
.then(data=>{
let html="";
data.forEach(d=>{html+="<div>"+d.amount+" | "+d.status+"</div>"});
document.getElementById("depositHistory").innerHTML=html;
});
}
loadDepositHistory();

function loadWins(){
fetch("/user-wins")
.then(r=>r.json())
.then(data=>{
let html="";
data.forEach(w=>{html+="<div>Win: "+w.amount+"</div>"});
document.getElementById("winsList").innerHTML=html;
});
}
loadWins();

</script>
</body>
</html>
