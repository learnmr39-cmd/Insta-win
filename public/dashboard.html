<!DOCTYPE html>
<html>
<head>

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>

body{
margin:0;
background:#0b0b12;
font-family:Arial;
color:white;
}

/* SIDE MENU */

.menu{
position:fixed;
left:-260px;
top:0;
width:260px;
height:100%;
background:#141422;
transition:0.4s;
padding-top:20px;
}

.menu a{
display:block;
padding:15px;
color:gold;
text-decoration:none;
}

.menu.active{left:0}

.header{
background:#141422;
padding:15px;
display:flex;
justify-content:space-between;
}

.section{display:none;padding:15px}
.section.active{display:block}

/* WHEEL */

#wheel{
width:250px;
height:250px;
border-radius:50%;
margin:auto;
background:conic-gradient(
gold 0deg 60deg,
red 60deg 120deg,
blue 120deg 180deg,
green 180deg 240deg,
purple 240deg 300deg,
orange 300deg 360deg
);
transition:transform 5s cubic-bezier(.17,.67,.83,.67);
}

.winGlow{
box-shadow:0 0 30px gold;
}

</style>

</head>

<body>

<div class="menu" id="menu">

<a onclick="show('home')">Home</a>
<a onclick="show('wins')">Wins</a>
<a onclick="show('analytics')">Analytics</a>

</div>

<div class="header">
<button onclick="toggle()">â˜°</button>
<div id="balance">Balance:0</div>
</div>

<div id="home" class="section active">

<div id="wheel"></div>

<button onclick="spin()">SPIN</button>

</div>

<div id="wins" class="section">

<h3>Win History</h3>

<div id="winsList"></div>

</div>

<div id="analytics" class="section">

<h3>Admin Analytics</h3>

<div id="stats"></div>

</div>

<audio id="winSound" src="https://www.soundjay.com/misc/sounds/bell-ringing-05.mp3"></audio>

<script>

function toggle(){
document.getElementById("menu").classList.toggle("active");
}

function show(id){
document.querySelectorAll(".section").forEach(s=>s.classList.remove("active"));
document.getElementById(id).classList.add("active");
toggle();
}

function loadBalance(){
fetch("/balance")
.then(r=>r.json())
.then(d=>{
document.getElementById("balance").innerText="Balance:"+d.balance;
});
}

loadBalance();
setInterval(loadBalance,4000);

function spin(){

fetch("/spin",{method:"POST"})
.then(r=>r.json())
.then(data=>{

if(data.error){
alert(data.error);
return;
}

let wheel=document.getElementById("wheel");

let degree=1440+Math.random()*360;

wheel.style.transform="rotate("+degree+"deg)";

wheel.classList.add("winGlow");

document.getElementById("winSound").play();

setTimeout(()=>{
wheel.classList.remove("winGlow");
loadBalance();
loadWins();
},5000);

});

}

function loadWins(){

fetch("/user-wins")
.then(r=>r.json())
.then(data=>{
let html="";
data.forEach(w=>{
html+="<div>Win: "+w.amount+"</div>";
});
document.getElementById("winsList").innerHTML=html;
});

}

loadWins();

function loadStats(){

fetch("/admin-stats")
.then(r=>r.json())
.then(d=>{
document.getElementById("stats").innerHTML=
"Users: "+d.users+"<br>Total Wins: "+d.totalWins;
});

}

loadStats();

</script>

</body>
</html>
