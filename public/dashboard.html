<!DOCTYPE html>
<html>
<head>
<title>Silk Lucky Draw</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>

body{
margin:0;
background:#0b0b12;
font-family:Arial;
color:white;
}

.wrapper{
min-height:100vh;
display:flex;
justify-content:center;
align-items:center;
padding:15px;
}

.card{
background:#141422;
border-radius:16px;
padding:20px;
width:100%;
max-width:420px;
box-shadow:0 0 30px rgba(255,215,0,0.25);
text-align:center;
}

h2{
margin-top:0;
}

input{
width:100%;
padding:12px;
margin-top:8px;
margin-bottom:8px;
border:none;
border-radius:10px;
font-size:16px;
}

button{
width:100%;
padding:12px;
margin-top:8px;
border:none;
border-radius:10px;
background:gold;
font-weight:bold;
font-size:16px;
cursor:pointer;
}

canvas{
width:100%;
height:auto;
max-width:320px;
margin-top:20px;
}

@media(min-width:768px){
.wrapper{
padding:40px;
}
.card{
max-width:500px;
}
}

</style>

</head>

<body>

<div class="wrapper">

<div class="card">

<h2>Silk Lucky Draw</h2>

<h3 id="balance">Balance: 0</h3>

<form method="POST" action="/deposit">
<input type="number" name="amount" placeholder="Deposit amount" required>
<button>Deposit</button>
</form>

<form method="POST" action="/withdraw">
<input type="number" name="amount" placeholder="Withdraw amount" required>
<button>Withdraw</button>
</form>

<canvas id="wheel" width="300" height="300"></canvas>

<button onclick="spin()">SPIN NOW</button>

</div>

</div>

<script>

let balance = 0;
const spinCost = 5;

fetch("/balance")
.then(res=>res.json())
.then(data=>{
balance = data.balance;
updateBalance();
});

function updateBalance(){
document.getElementById("balance").innerText = "Balance: " + balance;
}

const canvas = document.getElementById("wheel");
const ctx = canvas.getContext("2d");

const rewards = [0,10,20,50,100,5];
let rotation = 0;

function drawWheel(){

const colors=["gold","#ff0055","#00c3ff","#00ff88","#a200ff","#ff8800"];

for(let i=0;i<6;i++){

ctx.beginPath();
ctx.moveTo(150,150);
ctx.arc(150,150,150,i*(Math.PI*2/6),(i+1)*(Math.PI*2/6));
ctx.fillStyle=colors[i];
ctx.fill();

ctx.save();
ctx.translate(150,150);
ctx.rotate((i+0.5)*(Math.PI*2/6));
ctx.fillStyle="white";
ctx.font="bold 20px Arial";
ctx.fillText(rewards[i],90,0);
ctx.restore();

}

}

drawWheel();

function spin(){

if(balance < spinCost){
alert("Not enough balance");
return;
}

balance -= spinCost;
updateBalance();

let spinAmount = Math.floor(Math.random()*360)+1080;
let start = null;

function animate(timestamp){

if(!start) start = timestamp;

let progress = timestamp - start;
rotation = spinAmount * (progress/5000);

ctx.clearRect(0,0,300,300);

ctx.save();
ctx.translate(150,150);
ctx.rotate(rotation*Math.PI/180);
ctx.translate(-150,-150);
drawWheel();
ctx.restore();

if(progress < 5000){
requestAnimationFrame(animate);
}else{

const win = rewards[Math.floor(Math.random()*rewards.length)];

balance += win;
updateBalance();

alert("You won " + win);

}

}

requestAnimationFrame(animate);

}

</script>

</body>
</html>
